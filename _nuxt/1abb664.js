(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{300:function(e,t,n){var content=n(304);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(117).default)("e8c57c66",content,!0,{sourceMap:!1})},301:function(e,t,n){var content=n(306);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(117).default)("536ffdd9",content,!0,{sourceMap:!1})},302:function(e,t,n){"use strict";var r=n(3),o=n(88).find,l=n(142),c="find",d=!0;c in[]&&Array(1)[c]((function(){d=!1})),r({target:"Array",proto:!0,forced:d},{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),l(c)},303:function(e,t,n){"use strict";n(300)},304:function(e,t,n){var r=n(116)(!1);r.push([e.i,".sb-radio__description label:after,.sb-radio__description label:before{content:none!important}.flex{display:flex}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-center{justify-content:center}.text-center{text-align:center}.text-start{text-align:left}",""]),e.exports=r},305:function(e,t,n){"use strict";n(301)},306:function(e,t,n){var r=n(116)(!1);r.push([e.i,".content[data-v-8bad19e6]{display:flex;flex-direction:column}",""]),e.exports=r},309:function(e,t,n){"use strict";n.r(t);n(36),n(30),n(57),n(58);var r=n(24),o=n(23),l=n(2),c=(n(56),n(143),n(74),n(35),n(13),n(55),n(54),n(144),n(45),n(89),n(207),n(302),n(26),n(53),n(25),n(1)),d=n(51);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=new Intl.DisplayNames([navigator.language],{type:"region"}),m=new Intl.DisplayNames([navigator.language],{type:"language"});function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;try{return m.of(e.toUpperCase())||t}catch(n){return console.error('Failed to format language "'.concat(e,'"'),n),t}}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;try{return v.of(e.toUpperCase())||t}catch(n){return console.error('Failed to format region "'.concat(e,'"'),n),t}}var x=c.default.extend({data:function(){return{updateTimeout:void 0,showModal:!1,isRefreshRequired:!1,story:void 0,sourceLanguage:void 0,copyFrom:void 0,alternates:[],chosenTranslateAction:"translate",requestedTranslation:!1,requestedImport:!1,errorMessage:void 0,successMessage:void 0,dryRun:!1,forcePublish:!1,supportedLanguages:[],chosenAction:"translate",isWorking:!1,canTranslate:!1,language:void 0,brand:void 0,singleTranslationAllowed:!1,isTranslationBrand:!1,chosenTranslateActionTranslatedBrands:"translateAll",translationFiles:void 0}},mounted:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:window.top==window.self&&window.location.assign("https://app.storyblok.com/oauth/tool_redirect"),n=e.$refs.pluginWrapper,r=new ResizeObserver((function(){return e.updateHeight()})),e.updateHeight(),r.observe(n),window.addEventListener("message",(function(t){e.processMessage(t),e.updateHeight()}),!1),window.parent.postMessage({action:"tool-changed",tool:"translate-page",event:"getContext"},"https://app.storyblok.com");case 7:case"end":return t.stop()}}),t)})))()},computed:h(h(h({},Object(d.d)("storyblok",["components"])),Object(d.d)("auth",["spaceId"])),{},{form:function(){return this.$refs.form}}),watch:{sourceLanguage:function(e){this.canTranslate=!!(this.sourceLanguage||this.sourceLanguage&&this.translationFiles)},translationFiles:function(e){this.canTranslate=!!(this.sourceLanguage||this.sourceLanguage&&this.translationFiles)}},methods:h(h(h({},Object(d.c)("deepl",["retrieveSupportedLanguages"])),Object(d.c)("systemair",["translateStory","importTranslationFiles"])),{},{updateHeight:function(){clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout((function(){var e=Math.max(document.body.scrollHeight,document.body.offsetHeight),t=document.querySelector(".sb-modal"),n=(null==t?void 0:t.offsetHeight)||0,r=t&&2*parseFloat(t.parentElement?window.getComputedStyle(t.parentElement).padding:"")||0;window.parent.postMessage({action:"tool-changed",tool:"translate-page",event:"heightChange",height:Math.max(e,n+r)+5},"https://app.storyblok.com")}),100)},processMessage:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=["frico","fantech","menerga"],!e.data||"get-context"!=e.data.action||!t.spaceId){n.next=14;break}return l=e.data.story.full_slug.split("/",1)[0],t.language=e.data.language||"Default",t.singleTranslationAllowed="Default"!==t.language&&!t.language.startsWith("en"),t.brand=l.split("-",1)[0],t.isTranslationBrand=o.includes(t.brand),t.story=e.data.story,t.alternates=(e.data.story.alternates||[]).map((function(e){var t=e.full_slug,n=t.indexOf("/"),o=t.slice(0,n+1),l=o.slice(o.indexOf("-")+1).split("/")[0].split("-"),c=Object(r.a)(l,2),d=c[0],f=c[1];return{value:o,label:[f&&y(f),d&&_(d)].filter(Boolean).join(" - ")}})).filter((function(e){return!e.value.startsWith("systemair-en/")})),n.next=11,t.retrieveSupportedLanguages(t.spaceId);case 11:c=n.sent,t.supportedLanguages=c.map((function(e){var t=e.name,code=e.code;return{name:t,language:code,formattedLanguage:_(code,t)}})),t.trySelectDefaultSourceLanguage();case 14:case"end":return n.stop()}}),n)})))()},trySelectDefaultSourceLanguage:function(){if(this.story){var e=this.story.full_slug.split("/",1)[0];if(e){var t=e.split("-").splice(1);if(t.length>0){var n=t[0].toUpperCase(),r=this.supportedLanguages.find((function(e){return e.language===n}));r&&(this.sourceLanguage=r.language)}}}},hideModal:function(){this.showModal=this.requestedTranslation=this.requestedImport=!1,this.errorMessage=this.successMessage=void 0,this.updateHeight()},submitFormTranslated:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var form,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.preventDefault(),form=t.form,t.chosenAction,r=t.requestedTranslation,t.requestedImport,form.checkValidity()){n.next=5;break}return form.reportValidity(),n.abrupt("return");case 5:if(!r){n.next=10;break}return t.requestedTranslation=!1,n.abrupt("return",t.handleTranslateStory());case 10:t.requestedTranslation=!0,t.showModal=!0;case 12:case"end":return n.stop()}}),n)})))()},submitForm:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var form,r,o,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.preventDefault(),form=t.form,r=t.chosenAction,o=t.requestedTranslation,l=t.requestedImport,form.checkValidity()){n.next=5;break}return form.reportValidity(),n.abrupt("return");case 5:if("translate"!==r){n.next=14;break}if(!o){n.next=11;break}return t.requestedTranslation=!1,n.abrupt("return",t.handleTranslateStory());case 11:t.requestedTranslation=!0,t.showModal=!0;case 13:return n.abrupt("return");case 14:if(!l){n.next=19;break}return t.requestedImport=!1,n.abrupt("return",t.handleImportTranslationFiles());case 19:t.requestedImport=!0,t.showModal=!0;case 21:case"end":return n.stop()}}),n)})))()},handleTranslateStory:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,r,o,l,c,d,f,v,m,_,y,x,T,w,S,k,A,C,M;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,v=e.story,m=e.spaceId,_=e.copyFrom,y=e.chosenTranslateActionTranslatedBrands,x=e.chosenTranslateAction,T=e.sourceLanguage,v){t.next=4;break}return t.abrupt("return");case 4:if(e.isWorking=!0,w="translateAll"===y,S="overwrite"===x,k="extend"===x,e.isTranslationBrand||T&&(!S&&!k||_)){t.next=11;break}return e.errorMessage="Missing required data (current story, source language or from story)",t.abrupt("return");case 11:return t.next=13,e.translateStory(h({brand:e.brand,spaceId:m,storyId:v.id},e.isTranslationBrand?{sourceLanguage:"en",translateAll:w,storyLocale:e.language}:{sourceLanguage:T,overwriteContent:S,extendContent:k,copyFrom:_}));case 13:A=t.sent,C=[],M=[],A.response&&A.response.forEach((function(e){var t=e.locale,n=e.translations;C.push("".concat(t,": ").concat(n," Translations"))})),A.failedStories&&A.failedStories.forEach((function(e){M.push(e)})),C.length||M.length?e.successMessage="\n            ".concat(C.length?C.join("<br>"):"N/A","\n            ").concat(M.length?"<br><br>Not translated languages:<br>".concat(M.join("<br>")):"","\n          "):e.successMessage="\n            <strong>Deleted:</strong> ".concat(null!==(n=A.deletedCount)&&void 0!==n?n:"N/A","<br>\n            <strong>Inserted:</strong> ").concat(null!==(r=A.insertedCount)&&void 0!==r?r:"N/A","<br>\n            <strong>Merged:</strong> ").concat(null!==(o=A.mergedCount)&&void 0!==o?o:"N/A","<br>\n            <strong>Translations:</strong> ").concat(null!==(c=null!==(l=A.translationsCount)&&void 0!==l?l:A.translations)&&void 0!==c?c:"N/A","\n          "),e.isRefreshRequired=!0,t.next=26;break;case 22:t.prev=22,t.t0=t.catch(0),console.error(t.t0),e.errorMessage=(null===(f=null===(d=t.t0.response)||void 0===d?void 0:d.data)||void 0===f?void 0:f.error)||t.t0.message;case 26:return t.prev=26,e.isWorking=!1,t.finish(26);case 29:case"end":return t.stop()}}),t,null,[[0,22,26,29]])})))()},handleImportTranslationFiles:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,r,o,l,c,d,f,h,v,m,_;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,o=e.story,l=e.spaceId,c=e.sourceLanguage,d=e.forcePublish,o){t.next=4;break}return t.abrupt("return");case 4:if(e.isWorking=!0,f=null===(n=document.querySelector("#translationfiles"))||void 0===n?void 0:n.files,c&&f){t.next=9;break}return e.errorMessage="Missing required data (current story, source language or files)",t.abrupt("return");case 9:return t.next=11,e.importTranslationFiles({spaceId:l,storyId:o.id,sourceLanguage:c,translationFiles:f,forcePublish:d});case 11:h=t.sent,e.isRefreshRequired=!0,e.successMessage="\n          <strong>Count</strong>: ".concat((null==h?void 0:h.filesCount)||0,"<br>\n          <strong>Success</strong>: ").concat(((null==h?void 0:h.successFiles)||[]).join("<br>")||"N/A","<br>\n          <strong>Errors</strong>: ").concat(((null==h?void 0:h.errorFiles)||[]).join("<br>")||"N/A","\n        "),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(0),v=(null===(r=t.t0.response)||void 0===r?void 0:r.data)||{errorFiles:[]},m=v.errorFiles,_=v.error,e.errorMessage=(null==m?void 0:m.join(", "))||_||t.t0.message;case 20:return t.prev=20,e.isWorking=!1,t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[0,16,20,23]])})))()},fileSelected:function(){var e;this.translationFiles=null===(e=document.querySelector("#translationfiles"))||void 0===e?void 0:e.files}})}),T=(n(303),n(305),n(70)),component=Object(T.a)(x,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{ref:"pluginWrapper",staticClass:"content",on:{click:function(t){return e.updateHeight()}}},[e.story?t("div",[e.isRefreshRequired?t("SbCard",[t("SbCardContent",{staticClass:"font-size-lg text-center"},[t("p",[t("SbIcon",{attrs:{name:"success-pictogram",size:"large"}}),e._v(" Translation complete\n          "),t("br"),t("br"),e._v(" "),t("strong",[e._v("The page must be reloaded to display the updated story.")])],1),e._v(" "),e.successMessage?[t("hr",{staticClass:"text-primary",staticStyle:{"border-width":"1px 0px 0px","border-style":"solid"}}),e._v(" "),e.successMessage?t("p",{staticClass:"text-start sb-form-group__description",domProps:{innerHTML:e._s(e.successMessage)}}):e._e()]:e._e()],2)],1):[e.showModal?[t("SbModal",{attrs:{large:"","is-open":!0,"show-close":!1,"esc-closes":!1,"close-on-header":!1},on:{hide:e.hideModal}},[t("SbModalHeader",[t("SbIcon",{attrs:{name:"caution-pictogram",size:"x-large"}}),e._v(" "),t("span",[e._v("Attention")])],1),e._v(" "),t("SbModalContent",[e.errorMessage?[t("div",{staticClass:"font-size-md"},[t("strong",[t("SbIcon",{attrs:{name:"x-clear",color:"negative"}}),e._v(" An error occurred\n                ")],1),e._v(" "),t("p",[e._v(e._s(e.errorMessage))])])]:e.successMessage?[t("div",{staticClass:"font-size-md"},[t("strong",[t("SbIcon",{attrs:{name:"success-pictogram"}}),e._v(" Was successful\n                ")],1),e._v(" "),e.successMessage?t("p",{domProps:{innerHTML:e._s(e.successMessage)}}):e._e()])]:[e.isWorking?t("SbFormItem",[t("div",{staticClass:"flex flex-col items-center justify-center"},[t("SbLoading",{attrs:{type:"spinner"}})],1)]):[e.requestedImport?[t("p",[e._v("You are about to import the selected translation files and overwrite the content of the stories")])]:e._e(),e._v(" "),e.requestedTranslation?[t("p",[e._v("You are about to translate the content of the current story")])]:e._e(),e._v(" "),t("p",[t("strong",[t("SbIcon",{staticClass:"text-primary",attrs:{name:"circular-info"}}),e._v(" Attention\n                  ")],1),e._v(" "),t("br"),e._v("\n                  Please note that all changes will be made to the "),t("strong",[e._v("draft")]),e._v(" version of this story.\n                ")]),e._v(" "),t("p",[e._v("\n                  We recommend to publish the story beforehand in order to have a backup via the Storyblok history.\n                ")]),e._v(" "),t("p",[e._v("\n                  The same applies when loading stories from other locales.\n                ")]),e._v(" "),t("p",[e._v("Do you want to proceed?")])]]],2),e._v(" "),t("SbModalFooter",{staticClass:"justify-center"},[t("SbButton",{attrs:{size:"small",label:e.successMessage?"Close":"Cancel",type:"button",variant:"secondary",disabled:e.isWorking},on:{click:e.hideModal}}),e._v(" "),e.errorMessage||e.successMessage?e._e():t("SbButton",{attrs:{size:"small",label:"Proceed",variant:"primary",type:"button",disabled:e.isWorking},on:{click:e.submitForm}})],1)],1)]:e._e(),e._v(" "),e.isTranslationBrand?[t("form",{ref:"form",on:{submit:e.submitFormTranslated}},[t("SbFormItem",{attrs:{label:"Languages"}},[t("SbFormItem",[t("SbRadio",{attrs:{value:"translateAll",nativeValue:"translateAll",id:"chosen-translation-action-translate",name:"chosen-translate-action",label:"Translate ALL languages from Default"},model:{value:e.chosenTranslateActionTranslatedBrands,callback:function(t){e.chosenTranslateActionTranslatedBrands=t},expression:"chosenTranslateActionTranslatedBrands"}}),e._v(" "),t("div",{staticClass:"sb-radio__description"},[t("div",{staticClass:"sb-radio__input"}),e._v(" "),t("label",{staticClass:"sb-radio__label font-size-sm sb-form-group__description text-light-gray"},[e._v("\n                  All non-English languages will be translated from the "),t("em",[e._v("Default")]),e._v(" language\n                ")])])],1),e._v(" "),e.singleTranslationAllowed?t("SbFormItem",[t("SbRadio",{attrs:{value:"translateSingle",nativeValue:"translateSingle",id:"chosen-translation-action-extend",name:"chosen-translate-action",label:"Translate "+e.language.toUpperCase()+" from Default"},model:{value:e.chosenTranslateActionTranslatedBrands,callback:function(t){e.chosenTranslateActionTranslatedBrands=t},expression:"chosenTranslateActionTranslatedBrands"}}),e._v(" "),t("div",{staticClass:"sb-radio__description"},[t("div",{staticClass:"sb-radio__input"}),e._v(" "),t("label",{staticClass:"sb-radio__label font-size-sm sb-form-group__description text-light-gray"},[e._v("\n                  The current language "),t("strong",[e._v(e._s(e.language.toUpperCase()))]),e._v(" will be translated from the "),t("em",[e._v("Default")]),e._v(" language\n                ")])])],1):e._e()],1),e._v(" "),t("SbButton",{attrs:{"is-full-width":"",icon:"content",label:"Translate",size:"small",type:"submit"}})],1)]:[t("form",{ref:"form",on:{submit:e.submitForm}},[t("SbFormItem",{staticClass:"sb-form-group__description"},[e._v("\n            You can choose between translating the current story's content or uploading translation files to do so.\n          ")]),e._v(" "),t("SbFormItem",{attrs:{label:"Select action"}},[t("SbRadio",{attrs:{value:"translate",nativeValue:"translate",id:"chosen-section-translate",name:"chosen-action",label:"Translate current story"},model:{value:e.chosenAction,callback:function(t){e.chosenAction=t},expression:"chosenAction"}})],1),e._v(" "),t("SbFormItem",[t("SbRadio",{attrs:{value:"import",nativeValue:"import",name:"chosen-action",id:"chosen-section-import",label:"Upload translation file(s)"},model:{value:e.chosenAction,callback:function(t){e.chosenAction=t},expression:"chosenAction"}})],1),e._v(" "),"translate"===e.chosenAction?[t("SbFormItem",{attrs:{label:"Select translation type"}},[t("SbFormItem",[t("SbRadio",{attrs:{value:"translate",nativeValue:"translate",id:"chosen-translation-action-translate",name:"chosen-translate-action",label:"Translate story"},model:{value:e.chosenTranslateAction,callback:function(t){e.chosenTranslateAction=t},expression:"chosenTranslateAction"}}),e._v(" "),t("div",{staticClass:"sb-radio__description"},[t("div",{staticClass:"sb-radio__input"}),e._v(" "),t("label",{staticClass:"sb-radio__label font-size-sm sb-form-group__description text-light-gray"},[e._v("\n                    The story is translated into the locale of the current page.\n                  ")])])],1),e._v(" "),t("SbFormItem",[t("SbRadio",{attrs:{value:"extend",nativeValue:"extend",id:"chosen-translation-action-extend",name:"chosen-translate-action",label:"Extend story"},model:{value:e.chosenTranslateAction,callback:function(t){e.chosenTranslateAction=t},expression:"chosenTranslateAction"}}),e._v(" "),t("div",{staticClass:"sb-radio__description"},[t("div",{staticClass:"sb-radio__input"}),e._v(" "),t("label",{staticClass:"sb-radio__label font-size-sm sb-form-group__description text-light-gray"},[e._v("\n                    The content of a story from another locale is translated and then added to the current story.\n                  ")])])],1),e._v(" "),t("SbFormItem",[t("SbRadio",{attrs:{value:"overwrite",id:"chosen-translation-action-overwrite",nativeValue:"overwrite",name:"chosen-translate-action",label:"Overwrite story"},model:{value:e.chosenTranslateAction,callback:function(t){e.chosenTranslateAction=t},expression:"chosenTranslateAction"}}),e._v(" "),t("div",{staticClass:"sb-radio__description"},[t("div",{staticClass:"sb-radio__input"}),e._v(" "),t("label",{staticClass:"sb-radio__label font-size-sm sb-form-group__description text-light-gray"},[e._v("\n                    The content of the current story is replaced by the content of another story from another locale and then translated.\n                  ")])])],1)],1),e._v(" "),t("SbFormItem",{attrs:{label:"Current language of this story"}},[t("SbSelect",{attrs:{label:"Current language of this story",name:"source-language",options:e.supportedLanguages,"item-label":"formattedLanguage","item-value":"language",filterable:"",required:""},model:{value:e.sourceLanguage,callback:function(t){e.sourceLanguage=t},expression:"sourceLanguage"}})],1),e._v(" "),"translate"!==e.chosenTranslateAction?t("SbFormItem",{attrs:{label:("overwrite"===e.chosenTranslateAction?"Overwrite":"Extend")+" story from"}},[t("SbSelect",{attrs:{label:"Overwrite/extend story from",name:"copy-from",options:e.alternates,"item-label":"label","item-value":"value",filterable:"",required:""},model:{value:e.copyFrom,callback:function(t){e.copyFrom=t},expression:"copyFrom"}})],1):e._e()]:e._e(),e._v(" "),"import"===e.chosenAction?[t("SbFormItem",{staticStyle:{display:"flex","flex-direction":"column"},attrs:{label:"Translate from file(s)"}},[t("input",{staticClass:"sb-textfield__input sb-textfield__input--default",staticStyle:{"background-color":"white","max-width":"-webkit-fill-available"},attrs:{type:"file",required:"",id:"translationfiles",name:"translationfiles",accept:"application/json",multiple:""},on:{change:e.fileSelected}})]),e._v(" "),t("SbFormItem",[t("SbCheckbox",{attrs:{value:!1,id:"submit-button",name:"force-publish",label:"Publish the translated story/stories",inline:""},model:{value:e.forcePublish,callback:function(t){e.forcePublish=t},expression:"forcePublish"}}),e._v(" "),t("div",{staticClass:"sb-radio__description"},[t("div",{staticClass:"sb-radio__input"}),e._v(" "),t("label",{staticClass:"sb-radio__label font-size-sm sb-form-group__description text-light-gray"},[e._v("\n                  When selected, the updated story/stories will be published after they're translated. Use with care!\n                ")])])],1)]:e._e(),e._v(" "),t("SbButton",{attrs:{"is-full-width":"",isDisabled:!e.canTranslate,icon:"content",label:"Translate",size:"small",type:"submit"}})],2)]]],2):e._e()])}),[],!1,null,"8bad19e6",null);t.default=component.exports}}]);